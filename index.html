<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#0b0f19">
<title>Log Muscu</title>

<style>
:root{
  --bg:#0b0f19; --card:#121a2b; --muted:#9aa6c3; --text:#eaf0ff;
  --input:#fff2cc; --auto:#e7f3ff; --ok:#b7f7c8; --warn:#ffe3ad; --bad:#ffb3b3;
  --accent:#7aa8ff; --r:18px;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  background:linear-gradient(180deg,#0b0f19,#070a12);
  color:var(--text);
  padding:14px 14px 90px;
}
header{
  position:sticky; top:0; z-index:10;
  background:rgba(11,15,25,.88);
  backdrop-filter: blur(10px);
  padding:10px;
  border-radius:var(--r);
  border:1px solid rgba(255,255,255,.06);
}
.row{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
.pill{
  font-size:12px; color:var(--muted);
  border:1px solid rgba(255,255,255,.1);
  padding:6px 10px; border-radius:999px;
}
select,button,input{font:inherit}
select{
  background:rgba(255,255,255,.08);
  color:var(--text);
  border:1px solid rgba(255,255,255,.12);
  padding:10px 12px; border-radius:14px;
}
button{
  background:rgba(122,168,255,.16);
  border:1px solid rgba(122,168,255,.35);
  color:var(--text);
  padding:10px 12px; border-radius:14px;
  font-weight:800;
}
button.ghost{
  background:transparent;
  border:1px solid rgba(255,255,255,.12);
}
button.danger{
  background:rgba(255,80,80,.14);
  border-color:rgba(255,80,80,.35);
}
button:disabled{opacity:.4}

.card{
  margin-top:12px;
  background:rgba(18,26,43,.92);
  border:1px solid rgba(255,255,255,.06);
  border-radius:var(--r);
  padding:12px;
}
.cardTitle{
  display:flex; justify-content:space-between; align-items:center;
}
.small{font-size:12px;color:var(--muted)}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  margin-top:10px;
}
.field{
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.08);
  border-radius:16px;
  padding:10px;
}
.field label{
  display:block; font-size:12px; color:var(--muted); margin-bottom:6px;
}
.num{
  width:100%; padding:14px 12px;
  border-radius:14px;
  border:1px solid rgba(0,0,0,.08);
  background:var(--input);
  font-size:18px; font-weight:900;
  text-align:center;
}
.autoBox{
  background:var(--auto); color:#111;
  border-radius:16px; padding:10px;
}
.autoBox .k{font-size:12px}
.autoBox .v{font-size:18px;font-weight:900}
.action{
  margin-top:10px;
  padding:14px; border-radius:16px;
  font-weight:900; text-align:center;
}
.action.ok{background:var(--ok)}
.action.warn{background:var(--warn)}
.action.bad{background:var(--bad)}
.exList{margin-top:10px; display:flex; flex-direction:column; gap:10px}
.hint{font-size:12px;color:var(--muted);margin-top:6px}
.toolbar{
  position:fixed; left:0; right:0; bottom:0;
  padding:12px;
  background:rgba(11,15,25,.9);
  display:flex; gap:10px;
}
.toolbar button{flex:1}
</style>
</head>

<body>

<header>
  <div class="row" style="justify-content:flex-end">
    <span class="pill" id="today"></span>
  </div>

  <div class="row" style="margin-top:8px">
    <select id="sessionSelect">
      <option>Haut A</option><option>Haut B</option>
      <option>Bas A</option><option>Bas B</option>
    </select>

    <button class="ghost" id="backBtn">‚¨ÖÔ∏è</button>
    <button class="ghost" id="homeBtn">üè†</button>
    <button class="ghost" id="statsBtn">üìà</button>
    <button class="ghost" id="settingsBtn">‚öôÔ∏è</button>

    <!-- Mini chrono -->
    <span class="row">
      <button class="ghost" id="t30">30s</button>
      <button class="ghost" id="t60">1m</button>
      <button class="ghost" id="t120">2m</button>
      <button class="ghost" id="timer" style="display:none;min-width:70px;font-weight:900">00:00</button>
    </span>

    <button id="newBtn">+ Nouvelle</button>
  </div>
</header>

<div id="main"></div>

<div class="toolbar">
  <button id="saveBtn">üíæ Sauver</button>
  <button id="exportBtn" class="ghost">‚¨áÔ∏è Export</button>
  <button id="importBtn" class="ghost">‚¨ÜÔ∏è Import</button>
</div>

<script>
/* ---------------- STATE ---------------- */
const KEY="log_muscu_final";
const sessions=["Haut A","Haut B","Bas A","Bas B"];
let db=JSON.parse(localStorage.getItem(KEY)||'{"workouts":[]}');
let view="home";
let currentId=null;

/* ---------------- UTILS ---------------- */
today.textContent=new Date().toLocaleDateString("fr-FR",{weekday:"short",day:"numeric",month:"short"});

/* ---------------- TIMER ---------------- */
let timerI=null,endAt=null;
function fmt(s){return String(Math.floor(s/60)).padStart(2,"0")+":"+String(s%60).padStart(2,"0")}
function showBtns(b){
  [t30,t60,t120].forEach(x=>x.style.display=b?"inline-block":"none");
  timer.style.display=b?"none":"inline-block";
}
function start(sec){
  clearInterval(timerI);
  endAt=Date.now()+sec*1000;
  showBtns(false);
  timerI=setInterval(()=>{
    const left=Math.max(0,Math.ceil((endAt-Date.now())/1000));
    timer.textContent=fmt(left);
    if(left<=0){clearInterval(timerI);showBtns(true)}
  },200);
}
t30.onclick=()=>start(30); t60.onclick=()=>start(60); t120.onclick=()=>start(120);
timer.onclick=()=>{clearInterval(timerI);showBtns(true)};

/* ---------------- WORKOUTS ---------------- */
function newWorkout(s){
  const w={id:Date.now()+"",session:s,date:new Date(),entries:[]};
  db.workouts.unshift(w); currentId=w.id; save(); return w;
}
function getWorkout(){
  return db.workouts.find(w=>w.id===currentId)||db.workouts[0];
}
function save(){localStorage.setItem(KEY,JSON.stringify(db))}

/* ---------------- NAV ---------------- */
backBtn.onclick=()=>view="workout",render();
homeBtn.onclick=()=>view="home",render();
statsBtn.onclick=()=>view="stats",render();
settingsBtn.onclick=()=>view="settings",render();
newBtn.onclick=()=>{newWorkout(sessionSelect.value);view="workout";render()};
sessionSelect.onchange=()=>{newWorkout(sessionSelect.value);view="workout";render()};

/* ---------------- RENDER ---------------- */
function render(){
  backBtn.style.display=view==="workout"?"none":"inline-block";
  if(view==="home"){
    const c=document.createElement("div"); c.className="card";
    c.innerHTML="<strong>Choisir une s√©ance</strong>";
    const l=document.createElement("div"); l.className="exList";
    sessions.forEach(s=>{
      const b=document.createElement("button"); b.className="ghost"; b.textContent=s;
      b.onclick=()=>{sessionSelect.value=s;newWorkout(s);view="workout";render()};
      l.appendChild(b);
    });
    c.appendChild(l); main.replaceChildren(c);
  }
  if(view==="workout"){
    const w=getWorkout(); if(!w)return;
    sessionSelect.value=w.session;
    const c=document.createElement("div"); c.className="card";
    c.innerHTML="<strong>"+w.session+"</strong>";
    main.replaceChildren(c);
  }
  if(view==="stats"){main.innerHTML="<div class='card'>Stats</div>"}
  if(view==="settings"){main.innerHTML="<div class='card'>R√©glages</div>"}
}
render();
</script>
</body>
</html>
